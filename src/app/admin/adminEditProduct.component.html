<app-header></app-header>
<div class="breadcrumbs">
    <a class="pl-1" routerLink="/store">
        <span class="oi oi-home"></span> Accueil</a> >
    <a class="pl-1" routerLink="/editor"> Administration</a> >
    <a class="pl-1">Edition produit</a>
</div>
<div class="wrapper">
    <div class="row">
        <div *ngIf="productId && edit == true" class="titleCart col-12">Produit courant: {{productId}}</div>
        <div class="border-bottom border-light">
            <button class="btn backToList m-2" routerLink="/editor/products">
                <span class="oi oi-caret-left"></span> Retour à la liste</button>

        </div>
    </div>
    <div class="row" *ngIf="product">
        <div class="p-3 col" >
            <span *ngIf="productExists" class="errorMessage">{{productExists}}</span>
            <div class="form-group row mt-4">
                <label class="col-md-3 col-form-label">Nom du produit:</label>
                <div class="col-md-9">
                    <input type="text" [(ngModel)]="product.name" name="name" class="form-control form-control-sm">
                </div>
            </div>
            <div class="form-group row mt-4">
                <label class="col-md-3 col-form-label">Catégorie du produit:</label>
                <div class="col-md-9">
                    <input type="text" [(ngModel)]="product.category" name="category" class="form-control form-control-sm">
                </div>
            </div>
            <div class="form-group row mt-4">
                <label class="col-md-3 col-form-label">Description du produit:</label>
                <div class="col-md-9">
                    <textarea [(ngModel)]="product.description" name="description" class="form-control form-control-sm"></textarea>
                </div>
            </div>
            <div class="form-group row mt-4">
                <label class="col-md-3 col-form-label">Disponibilité du produit:</label>
                <div class="col-md-9">
                    <input type="text" [(ngModel)]="product.available" name="available" class="form-control form-control-sm">
                </div>
            </div>

            <div class="form-group row mt-4">
                <label class="col-md-3 col-form-label">Prix du produit:</label>
                <div class="col-md-9">
                    <input type="number" [(ngModel)]="product.price" name="price" class="form-control form-control-sm">
                </div>
            </div>
            <div class="form-group row mt-4">
                <label class="col-md-3 col-form-label">Images du produit:</label>
                <div class="col-md-9">
                    <input type="file" name="image1" accept="image/*" class="form-control form-control-sm" (change)="onFileChange($event.target.files)">

                </div>
            </div>
            <div class="form-group row mt-4">
                <label class="col-md-3 col-form-label">Télécharger les images:</label>
                <div class="col-md-9">
                    <div *ngIf="arr.length>0">
                        <div *ngFor="let item of arr; let i=index">
                            <span>{{imgToSend}}</span> {{i+1}}: {{item}}&nbsp;
                            <span class="oi oi-x" (click)="deleteImg(item)"></span>
                        </div>
                    </div>
                    <button type="button" (click)="savePhotos()">Envoyer les photo sur le serveur</button>
                </div>
            </div>
            <div *ngIf="messageSuccess" class="col-6 text-right">
                <span class="text-success font-weight-bold">{{messageSuccess}}</span>
            </div>
            <div id="createPictures" class="pl-3 mt-4" *ngIf="photo">
                <div class="inBlock" *ngFor="let imgDisplayed of imgSrcs; let i=index" id="image_{{i}}">
                        <img class="imgMini"  src="data:image/jpeg;base64,{{imgDisplayed.src}}" />
                        <span class="deleteImg" (click)="deleteProductImg(i)" >
                            <span class="oi oi-circle-x"></span>
                        </span>
                </div>
                
            </div>
            <div class="pl-3 mt-4">
                <span class="errorMessage" *ngIf="fileExistsMess">{{fileExistsMess}}</span>
            </div>
            <br/>
            <hr>
            <div class="pl-3 mt-4">

                <button *ngIf="edit === true" class="btn btn-outline-warning mt-2" (click)="deleteProduct(product)">
                    Supprimer ce produit</button>
                <button type="submit " class="btn btn-primary mt-2" (click)="saveProduct(product) ">
                    Sauvegarder
                </button>
            </div>
            <div *ngIf="productUpdated" class="row mt-4 green big">{{productUpdated}}</div>
        </div>

    </div>
</div>